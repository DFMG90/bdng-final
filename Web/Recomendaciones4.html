<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Perfil del Cliente</title>
  <style>

    body {
      font-family: Arial, sans-serif;

      margin: 20px;
	        margin: 0;
      padding: 0;
      background-color: #ffe0e0;
    }
 header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 20px;
  background-color: #ffe0e0;
}

.boton-cerrar {
  padding: 10px 15px;
  background-color: black;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 14px;
}

.boton-cerrar:hover {
  background-color: darkred;
}

	
	h2  {
      color: white;
	  margin-bottom: 20px; /* Añadimos espacio debajo del título */
    }
	h3  {
      color: black;
    }
    .cliente-info {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
      background-color: black;
    }
    .productos, .recomendaciones {
      margin-bottom: 20px;
    }
    
    .productos {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  justify-content: center;
    margin-top: 20px; /* Añadir espacio superior para separarlo del título */
  padding-top: 20px; /* Más espacio en la parte superior si es necesario */

  clear: both; /* Limpia el flotado para que se alinee correctamente debajo */
}

.producto-item {
  border: 1px solid #ddd;
  border-radius: 8px;
  background-color: #fff;
  width: 250px;
  padding: 15px;
  text-align: center;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  transition: transform 0.3s, box-shadow 0.3s;
}

.producto-item:hover {
  transform: translateY(-5px);
  box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
}

.producto-item img {
  width: 100%;
  height: auto;
  border-radius: 8px;
  margin-bottom: 10px;
}

.producto-info h4 {
  font-size: 18px;
  color: #333;
  margin-bottom: 5px;
}

.producto-info p {
  font-size: 14px;
  color: #555;
  margin-bottom: 15px;
}

.boton-finalizar {
  padding: 10px 15px;
  background-color: #007BFF;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 14px;
}

.boton-finalizar:hover {
  background-color: #0056b3;
}
.tooltip {
  position: absolute;
  background-color: rgba(0, 0, 0, 0.7); /* Fondo oscuro para el tooltip */
  color: white; /* Texto blanco */
  padding: 10px; /* Espaciado interno */
  border-radius: 5px; /* Bordes redondeados */
  font-size: 14px; /* Tamaño de la fuente */
  max-width: 300px; /* Limitar el ancho máximo del tooltip */
  word-wrap: break-word; /* Asegura que el texto largo se divida */
  display: none; /* Ocultar el tooltip por defecto */
  z-index: 10; /* Asegura que el tooltip esté por encima de otros elementos */
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2); /* Sombra para hacerlo más visible */
}

.Comprascarrito-button  {
  width: 40px; /* Tamaño del icono */
  height: 40px; /* Tamaño del icono */
margin: 0;
vertical-align: middle;
 padding: 0;
 display: inline-block;
   cursor: pointer;
}

}
  </style>
</head>
<body>

<header>
  
   <img src="https://izzyshopstlouis.com/cdn/shop/files/3.png?v=1728041300" alt="logotipo" style="vertical-align: middle; margin-left: 5px; height: 4em;  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); ">
   <center>
  <div id="greeting" style="margin-top: 5px; font-size: 5px; color: #000000;"></div>
   
  <h1 >Perfil del Cliente</h1>
  </center>
  <a>
  <img src="https://cdn-icons-png.flaticon.com/512/318/318493.png" onclick="window.history.back();" alt="Compras" class="Comprascarrito-button"></button>
   <img src="https://img.icons8.com/?size=50&id=9720&format=png"  alt="Compras" class="Comprascarrito-button"></button>
  <button id="cerrarSesion" class="boton-cerrar">Cerrar Sesión</button>
  </a>
  
</header>


  <!-- Información del Cliente -->
  <div class="cliente-info">
    <h2>Datos del Cliente</h2>
    <p><strong style="color: white;">Nombre:</strong> <span id="cliente-nombre"  style="color: white;"></span></p>
    <p><strong style="color: white;">Email:</strong> <span id="cliente-email"  style="color: white;"></span></p>
  </div>
<div class="header3">
    <h3><center>Recomendaciones Basadas en Compras Anteriores</center></h3>

  </div>
  <!-- Tooltip -->
  <div id="tooltip" style="display: none; text-align: center; margin-top: 20px; color: green;">
    ¡Gracias por su compra!
  </div>
  <!-- Productos Comprados -->
  <div class="productos" id="productos">
 
  </div>
  <script>
  
    // Función para mostrar agradecimiento al finalizar
    function mostrarAgradecimiento() {
      const tooltip = document.getElementById('tooltip');
      tooltip.style.display = 'block';
      setTimeout(() => {
        tooltip.style.display = 'none';
      }, 3000);
    }
	let id_cliente;
    // Función para obtener los parámetros de la URL
    function obtenerParametros() {
      const urlParams = new URLSearchParams(window.location.search);
      const nombre = urlParams.get('nombre');
      const email = urlParams.get('email');
       id_cliente = urlParams.get('id_cliente');

      // Actualizar la información del cliente en la página
      document.getElementById('cliente-nombre').textContent = nombre || 'Nombre no disponible';
      document.getElementById('cliente-email').textContent = email || 'Email no disponible';
    }

    // Función para agregar productos al carrito
    function agregarAlCarrito(producto) {
      alert(`Producto agregado al carrito: ${producto}`);
    }

    // Función para obtener productos desde la API
async function obtenerProductos() {
    //const url = `https://cors-anywhere.herokuapp.com/https://7s98pr5chh.execute-api.eu-west-3.amazonaws.com/tienda/catalogo/?query=Rec&CLI1234`;
   const url = `https://cors-anywhere.herokuapp.com/https://7s98pr5chh.execute-api.eu-west-3.amazonaws.com/tienda/catalogo/?query=Rec&CLI=${id_cliente}`;
  try {
    const response = await fetch(url);
    const data = await response.json();
    console.log('Respuesta de la API:', data);

    // Verificar si la respuesta es válida
    if (Array.isArray(data)) {
      const productosContainer = document.getElementById('productos');
	        productosContainer.innerHTML = ""; // Limpiar cualquier contenido previo


      data.forEach((item) => {
        // Crear el elemento contenedor para cada producto
        const productoItem = document.createElement('div');
        productoItem.classList.add('producto-item');

        // Imagen del producto
        const img = document.createElement('img');
        img.src = item.urls3;
        img.alt = item.Producto;
		


		// Crear el tooltip
const tooltip = document.createElement('div');
tooltip.classList.add('tooltip');
tooltip.textContent = item.descripcion; // Texto del tooltip
console.log(item.Descripcion); 
// Agregar el tooltip al documento, pero oculto inicialmente
document.body.appendChild(tooltip);

// Mostrar el tooltip cuando el mouse pase sobre la imagen
img.addEventListener('mouseover', (event) => {
  tooltip.style.display = 'block';
  
  // Calcular la posición de forma que no se salga del borde de la ventana
  const offsetX = 10;  // Desplazamiento desde el cursor en el eje X
  const offsetY = 10;  // Desplazamiento desde el cursor en el eje Y
  const tooltipWidth = tooltip.offsetWidth;
  const tooltipHeight = tooltip.offsetHeight;
  
  let left = event.pageX + offsetX;
  let top = event.pageY + offsetY;

  // Ajustar la posición si el tooltip se sale del borde derecho o inferior de la ventana
  if (left + tooltipWidth > window.innerWidth) {
    left = event.pageX - tooltipWidth - offsetX;
  }
  if (top + tooltipHeight > window.innerHeight) {
    top = event.pageY - tooltipHeight - offsetY;
  }

  tooltip.style.left = `${left}px`;
  tooltip.style.top = `${top}px`;
});

// Ocultar el tooltip cuando el mouse sale de la imagen
img.addEventListener('mouseout', () => {
  tooltip.style.display = 'none';
});

        // Información del producto
        const productoInfo = document.createElement('div');
        productoInfo.classList.add('producto-info');

        const nombre = document.createElement('h4');
        nombre.textContent = item.Producto;

        const descripcion = document.createElement('p');
        descripcion.textContent = item.Descripcion;

        // Botón de agregar al carrito
        const boton = document.createElement('button');
        boton.classList.add('boton-finalizar');
        boton.textContent = 'Agregar al carrito';
        boton.onclick = () => agregarAlCarrito(item.Producto);

        // Agregar los elementos al contenedor del producto
        productoInfo.appendChild(nombre);
        productoInfo.appendChild(descripcion);
        productoItem.appendChild(img);
        productoItem.appendChild(productoInfo);
        productoItem.appendChild(boton);

        productosContainer.appendChild(productoItem);
      });
    } else {
      console.error("La API no devolvió un array de productos.");
    }
  } catch (error) {
    console.error('Error al obtener los productos:', error);
  }
}
document.getElementById('cerrarSesion').addEventListener('click', function() {
  window.location.href = 'index.html'; 
});

    // Llamar a la función para obtener los productos y parámetros al cargar la página
    window.onload = function() {
      obtenerParametros();
      obtenerProductos();
    };
  </script>
</body>
</html>
